<ion-header>
  <ion-toolbar>
    <ion-buttons slot="start">
      <ion-menu-button></ion-menu-button>
    </ion-buttons>
    <ion-title>
      {{ comics[0]?.series }} Vol. {{ comics[0]?.volume }}
    </ion-title>
  </ion-toolbar>
</ion-header>

<ion-content>
  <ion-card *ngFor="let comic of comics">
    <ion-card-header>
      <ion-card-title>#{{ comic.number }} {{ comic.title }}</ion-card-title>
      <ion-card-subtitle>{{ comic.year }}/{{ comic.month }}</ion-card-subtitle>
    </ion-card-header>

    <ion-card-content>
      <div class="thumbnail">
        <a [routerLink]="['/read', comic.id]"
           [queryParams]="{ page: 0, parent: currentRoute }">
          <ion-badge *ngIf="comic.read"
           class="read-badge" color="secondary">
            &#10004;
          </ion-badge>
          <img [src]="thumbnail(comic)">
        </a>
      </div>

      <ion-item>
        <ion-button *ngIf="comic.read; else notRead"
          class="read-toggle"
          color="primary" fill="clear"
          (click)="markAsUnread(comic)">
          <ion-icon name="qr-scanner"></ion-icon>
          Mark as unread
        </ion-button>
        <ng-template #notRead>
          <ion-button
            color="primary" fill="clear"
            class="read-toggle"
            (click)="markAsRead(comic)">
            <ion-icon name="checkmark"></ion-icon>
            Mark as read
          </ion-button>
        </ng-template>
        <ion-icon (click)="openMenu($event, comic)" slot="end" name="more"></ion-icon>
      </ion-item>

      <ion-item lines="none">
        <div [ngClass]="{'expanded': comic.summaryExpanded}" class="comic-summary" (click)="comic.summaryExpanded = !comic.summaryExpanded">
          {{ comic.summary }}
        </div>
      </ion-item>

    </ion-card-content>
  </ion-card>
</ion-content>
